# Лабораторна робота №5
**Дисципліна:** Теорія алгоритмів  
**Тема:** Алгоритми на графах. Мінімальне кістякове дерево  
**Варіант:** №24  

## Виконав
Студент групи ЕАІ-244  
Магдич О.В.  

**Перевірили:**  
Смик С. Ю., Арсірій О.О.  

**Місце та рік:** Одеса, 2025  

## Мета роботи
Набуття практичних навичок із проектування, реалізації, тестування та аналізу алгоритмів Прима та Крускала для побудови мінімального кістякового дерева (МКД) у зважених неорієнтованих графах.

## Завдання
1. Побудувати матриці та списки суміжності для зважених неорієнтованих графів.  
2. Побудувати МКД за алгоритмом Прима та показати графічно хід побудови.  
3. Реалізувати алгоритм Прима на Python, запустити та порівняти результати з ручною побудовою.  
4. Побудувати МКД за алгоритмом Крускала та показати хід побудови.  
5. Реалізувати алгоритм Крускала на Python, запустити та порівняти результати з ручною побудовою.  
6. Порівняти результати обох алгоритмів і пояснити відмінності.

## Варіант завдання (№24)
**Вершини графа:** 8  
**Ребра та ваги:**

| Ребро | Вага |
|-------|-----|
| (1,2) | 8   |
| (1,3) | 4   |
| (1,4) | 4   |
| (2,4) | 1   |
| (2,6) | 6   |
| (3,8) | 2   |
| (4,5) | 6   |
| (5,6) | 5   |
| (5,7) | 7   |
| (6,7) | 4   |
| (6,8) | 3   |
| (7,8) | 5   |

## 1. Матриця та список суміжності

**Матриця суміжності (8×8):**

|   | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
|---|---|---|---|---|---|---|---|---|
| 1 | 0 | 8 | 4 | 4 | 0 | 0 | 0 | 0 |
| 2 | 8 | 0 | 0 | 1 | 0 | 6 | 0 | 0 |
| 3 | 4 | 0 | 0 | 0 | 0 | 0 | 0 | 2 |
| 4 | 4 | 1 | 0 | 0 | 6 | 0 | 0 | 0 |
| 5 | 0 | 0 | 0 | 6 | 0 | 5 | 7 | 0 |
| 6 | 0 | 6 | 0 | 0 | 5 | 0 | 4 | 3 |
| 7 | 0 | 0 | 0 | 0 | 7 | 4 | 0 | 5 |
| 8 | 0 | 0 | 2 | 0 | 0 | 3 | 5 | 0 |

**Список суміжності:**

```

1: (2,8), (3,4), (4,4)
2: (1,8), (4,1), (6,6)
3: (1,4), (8,2)
4: (1,4), (2,1), (5,6)
5: (4,6), (6,5), (7,7)
6: (2,6), (5,5), (7,4), (8,3)
7: (5,7), (6,4), (8,5)
8: (3,2), (6,3), (7,5)

````

**Python-код побудови:**

```python
def build_adj_matrix(n, edges):
    A = [[0]*n for _ in range(n)]
    for u, v, w in edges:
        A[u-1][v-1] = w
        A[v-1][u-1] = w
    return A

def build_adj_list(n, edges):
    L = [[] for _ in range(n)]
    for u, v, w in edges:
        L[u-1].append((v, w))
        L[v-1].append((u, w))
    return L

edges = [
    (1,2,8),(1,3,4),(1,4,4),
    (2,4,1),(2,6,6),
    (3,8,2),(4,5,6),
    (5,6,5),(5,7,7),
    (6,7,4),(6,8,3),
    (7,8,5)
]

A = build_adj_matrix(8, edges)
L = build_adj_list(8, edges)
````

## 2. Алгоритм Прима

**Python-код:**

```python
import heapq

def prim_mst(n, adj):
    visited = [False]*(n+1)
    mst = []
    pq = []
    start = 1
    visited[start] = True
    for v, w in adj[start]:
        heapq.heappush(pq, (w, start, v))
    while pq and len(mst) < n-1:
        w, u, v = heapq.heappop(pq)
        if visited[v]: continue
        mst.append((u, v, w))
        visited[v] = True
        for to, wt in adj[v]:
            if not visited[to]:
                heapq.heappush(pq, (wt, v, to))
    return mst

adj = {i:[] for i in range(1,9)}
for u,v,w in edges:
    adj[u].append((v,w))
    adj[v].append((u,w))

mst = prim_mst(8, adj)
total = sum([w for _,_,w in mst])
print("МКД Прима:", mst)
print("Сумарна вага:", total)
```

## 3. Алгоритм Крускала

**Python-код:**

```python
class DSU:
    def __init__(self, n):
        self.parent = list(range(n+1))
    def find(self, x):
        if self.parent[x]!=x: self.parent[x]=self.find(self.parent[x])
        return self.parent[x]
    def unite(self, a,b):
        a,b=self.find(a),self.find(b)
        if a!=b: self.parent[a]=b

edges_sorted = sorted(edges, key=lambda x:x[2])
dsu = DSU(8)
mst,total=[],0
for u,v,w in edges_sorted:
    if dsu.find(u)!=dsu.find(v):
        dsu.unite(u,v)
        mst.append((u,v,w))
        total+=w
    if len(mst)==7: break

print("МКД Крускала:", mst)
print("Сумарна вага:", total)
```

## 4. Висновки

* Ознайомлено з алгоритмами Прима та Крускала для побудови МКД.
* Реалізовано обидва алгоритми на Python та перевірено співпадіння з ручним розрахунком.
* Прима нарощує дерево від однієї вершини, Крускал додає найменші ребра глобально.
* Проведено порівняння локальних і глобальних стратегій побудови МКД.

```
